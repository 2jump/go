"use strict";(self.webpackChunkcropperjs=self.webpackChunkcropperjs||[]).push([[697],{4697:function(t,e,n){n.r(e),n.d(e,{ACTION_MOVE:function(){return g},ACTION_NONE:function(){return C},ACTION_RESIZE_EAST:function(){return E},ACTION_RESIZE_NORTH:function(){return y},ACTION_RESIZE_NORTHEAST:function(){return T},ACTION_RESIZE_NORTHWEST:function(){return k},ACTION_RESIZE_SOUTH:function(){return S},ACTION_RESIZE_SOUTHEAST:function(){return O},ACTION_RESIZE_SOUTHWEST:function(){return x},ACTION_RESIZE_WEST:function(){return A},ACTION_ROTATE:function(){return v},ACTION_SCALE:function(){return b},ACTION_SELECT:function(){return m},ACTION_TRANSFORM:function(){return w},ATTRIBUTE_ACTION:function(){return N},CROPPER_CANVAS:function(){return h},CROPPER_CROSSHAIR:function(){return c},CROPPER_GIRD:function(){return l},CROPPER_HANDLE:function(){return u},CROPPER_IMAGE:function(){return d},CROPPER_SELECTION:function(){return p},CROPPER_SHADE:function(){return f},CROPPER_VIEWER:function(){return $},CropperCanvas:function(){return _t},CropperCrosshair:function(){return Qt},CropperElement:function(){return Ot},CropperGrid:function(){return Ft},CropperHandle:function(){return Ht},CropperImage:function(){return zt},CropperSelection:function(){return Bt},CropperShade:function(){return Vt},CropperViewer:function(){return oe},EVENT_ACTION:function(){return j},EVENT_ACTION_END:function(){return H},EVENT_ACTION_MOVE:function(){return U},EVENT_ACTION_START:function(){return L},EVENT_CHANGE:function(){return q},EVENT_ERROR:function(){return D},EVENT_KEYDOWN:function(){return W},EVENT_LOAD:function(){return Y},EVENT_POINTER_DOWN:function(){return P},EVENT_POINTER_MOVE:function(){return M},EVENT_POINTER_UP:function(){return z},EVENT_RESIZE:function(){return V},EVENT_TOUCH_END:function(){return _},EVENT_TOUCH_MOVE:function(){return R},EVENT_TOUCH_START:function(){return I},EVENT_TRANSFORM:function(){return B},EVENT_WHEEL:function(){return X},HAS_POINTER_EVENT:function(){return o},IS_BROWSER:function(){return i},IS_TOUCH_DEVICE:function(){return r},NAMESPACE:function(){return a},WINDOW:function(){return s},default:function(){return de},emit:function(){return pt},getAdjustedSizes:function(){return vt},getOffset:function(){return mt},isElement:function(){return it},isFunction:function(){return nt},isNaN:function(){return Z},isNumber:function(){return F},isObject:function(){return Q},isPlainObject:function(){return et},isPositiveNumber:function(){return G},isString:function(){return K},isUndefined:function(){return J},nextTick:function(){return $t},off:function(){return ct},on:function(){return lt},once:function(){return ut},toAngleInRadian:function(){return bt},toCamelCase:function(){return at},toKebabCase:function(){return rt}});const i="undefined"!=typeof window&&void 0!==window.document,s=i?window:{},r=!!i&&"ontouchstart"in s.document.documentElement,o=!!i&&"PointerEvent"in s,a="cropper",h=`${a}-canvas`,c=`${a}-crosshair`,l=`${a}-grid`,u=`${a}-handle`,d=`${a}-image`,p=`${a}-selection`,f=`${a}-shade`,$=`${a}-viewer`,m="select",g="move",b="scale",v="rotate",w="transform",C="none",y="n-resize",E="e-resize",S="s-resize",A="w-resize",T="ne-resize",k="nw-resize",O="se-resize",x="sw-resize",N="action",_=r?"touchend touchcancel":"mouseup",R=r?"touchmove":"mousemove",I=r?"touchstart":"mousedown",P=o?"pointerdown":I,M=o?"pointermove":R,z=o?"pointerup pointercancel":_,D="error",W="keydown",Y="load",V="resize",X="wheel",j="action",H="actionend",U="actionmove",L="actionstart",q="change",B="transform";function K(t){return"string"==typeof t}const Z=Number.isNaN||s.isNaN;function F(t){return"number"==typeof t&&!Z(t)}function G(t){return F(t)&&t>0&&t<1/0}function J(t){return void 0===t}function Q(t){return"object"==typeof t&&null!==t}const{hasOwnProperty:tt}=Object.prototype;function et(t){if(!Q(t))return!1;try{const{constructor:e}=t,{prototype:n}=e;return e&&n&&tt.call(n,"isPrototypeOf")}catch(t){return!1}}function nt(t){return"function"==typeof t}function it(t){return"object"==typeof t&&null!==t&&1===t.nodeType}const st=/([a-z\d])([A-Z])/g;function rt(t){return String(t).replace(st,"$1-$2").toLowerCase()}const ot=/-[A-z\d]/g;function at(t){return t.replace(ot,(t=>t.slice(1).toUpperCase()))}const ht=/\s\s*/;function ct(t,e,n,i){e.trim().split(ht).forEach((e=>{t.removeEventListener(e,n,i)}))}function lt(t,e,n,i){e.trim().split(ht).forEach((e=>{t.addEventListener(e,n,i)}))}function ut(t,e,n,i){lt(t,e,n,{...i,once:!0})}const dt={bubbles:!0,cancelable:!0,composed:!0};function pt(t,e,n,i){return t.dispatchEvent(new CustomEvent(e,{...dt,detail:n,...i}))}const ft=Promise.resolve();function $t(t,e){return e?ft.then(t?e.bind(t):e):ft}function mt(t){const{documentElement:e}=t.ownerDocument,n=t.getBoundingClientRect();return{left:n.left+(s.pageXOffset-e.clientLeft),top:n.top+(s.pageYOffset-e.clientTop)}}const gt=/deg|g?rad|turn$/i;function bt(t){const e=parseFloat(t)||0;if(0!==e){const[n="rad"]=String(t).match(gt)||[];switch(n.toLowerCase()){case"deg":return e/360*(2*Math.PI);case"grad":return e/400*(2*Math.PI);case"turn":return e*(2*Math.PI)}}return e}function vt(t,e="contain"){const{aspectRatio:n}=t;let{width:i,height:s}=t;const r=G(i),o=G(s);if(r&&o){const t=s*n;"contain"===e&&t>i||"cover"===e&&t<i?s=i/n:i=s*n}else r?s=i/n:o&&(i=s*n);return{width:i,height:s}}var wt=Object.defineProperty,Ct=(t,e,n)=>(((t,e,n)=>{e in t?wt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const yt=/left|top|width|height/i,Et="open",St=new WeakMap,At=new WeakMap,Tt=new Map,kt=s.document&&Array.isArray(s.document.adoptedStyleSheets)&&"replaceSync"in s.CSSStyleSheet.prototype;class Ot extends HTMLElement{constructor(){var t,e;super(),Ct(this,"$style"),Ct(this,"$template"),Ct(this,"shadowRootMode",Et),Ct(this,"slottable",!0),Ct(this,"themeColor");const n=null==(e=null==(t=Object.getPrototypeOf(this))?void 0:t.constructor)?void 0:e.$name;n&&Tt.set(n,this.tagName.toLowerCase())}get $sharedStyle(){return(this.themeColor?`:host{--theme-color: ${this.themeColor};}`:"")+"\n:host([hidden]) {\n  display: none !important;\n}\n"}static get observedAttributes(){return["shadow-root-mode","slottable","theme-color"]}attributeChangedCallback(t,e,n){if(Object.is(n,e))return;const i=at(t);let s=n;switch(typeof this[i]){case"boolean":s=null!==n&&"false"!==n;break;case"number":s=Number(n)}switch(this[i]=s,t){case"theme-color":{const t=At.get(this),e=this.$sharedStyle;t&&e&&(kt?t.replaceSync(e):t.textContent=e);break}}}$propertyChangedCallback(t,e,n){if(!Object.is(n,e))switch(t=rt(t),typeof n){case"boolean":!0===n?this.hasAttribute(t)||this.setAttribute(t,""):this.removeAttribute(t);break;case"number":n=Z(n)?"":String(n);default:n?this.getAttribute(t)!==n&&this.setAttribute(t,n):this.removeAttribute(t)}}connectedCallback(){Object.getPrototypeOf(this).constructor.observedAttributes.forEach((t=>{const e=at(t);let n=this[e];J(n)||this.$propertyChangedCallback(e,void 0,n),Object.defineProperty(this,e,{enumerable:!0,configurable:!0,get:()=>n,set(t){const i=n;n=t,this.$propertyChangedCallback(e,i,t)}})}));const t=this.attachShadow({mode:this.shadowRootMode||Et});if(this.shadowRoot||St.set(this,t),At.set(this,this.$addStyles(this.$sharedStyle)),this.$style&&this.$addStyles(this.$style),this.$template){const e=document.createElement("template");e.innerHTML=this.$template,t.appendChild(e.content)}if(this.slottable){const e=document.createElement("slot");t.appendChild(e)}}disconnectedCallback(){At.has(this)&&At.delete(this),St.has(this)&&St.delete(this)}$getTagNameOf(t){var e;return null!=(e=Tt.get(t))?e:t}$setStyles(t){return Object.keys(t).forEach((e=>{let n=t[e];F(n)&&(n=0!==n&&yt.test(e)?`${n}px`:String(n)),this.style[e]=n})),this}$getShadowRoot(){return this.shadowRoot||St.get(this)}$addStyles(t){let e;const n=this.$getShadowRoot();return kt?(e=new CSSStyleSheet,e.replaceSync(t),n.adoptedStyleSheets=n.adoptedStyleSheets.concat(e)):(e=document.createElement("style"),e.textContent=t,n.appendChild(e)),e}$emit(t,e,n){return pt(this,t,e,n)}$nextTick(t){return $t(this,t)}static $define(t,e){Q(t)&&(e=t,t=""),t||(t=this.$name||this.name),t=rt(t);const{customElements:n}=s;i&&n&&!n.get(t)&&n.define(t,this,e)}}Ct(Ot,"$name"),Ct(Ot,"$version","__VERSION__");var xt=Object.defineProperty,Nt=(t,e,n)=>(((t,e,n)=>{e in t?xt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class _t extends Ot{constructor(){super(...arguments),Nt(this,"$onPointerDown",null),Nt(this,"$onPointerMove",null),Nt(this,"$onPointerUp",null),Nt(this,"$onWheel",null),Nt(this,"$wheeling",!1),Nt(this,"$pointers",new Map),Nt(this,"$style",'\n:host {\n  display: block;\n  min-height: 100px;\n  min-width: 200px;\n  overflow: hidden;\n  position: relative;\n  touch-action: none;\n  user-select: none;\n}\n\n:host([background]) {\n  background-color: #fff;\n  background-image: repeating-linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc), repeating-linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%, #ccc);\n  background-image: repeating-conic-gradient(#ccc 0 25%, #fff 0 50%);\n  background-position: 0 0, 0.5rem 0.5rem;\n  background-size: 1rem 1rem;\n}\n\n:host([disabled]) {\n  pointer-events: none;\n}\n\n:host([disabled])::after {\n  bottom: 0;\n  content: "";\n  cursor: not-allowed;\n  display: block;\n  left: 0;\n  pointer-events: none;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n'),Nt(this,"$action",C),Nt(this,"background",!1),Nt(this,"disabled",!1),Nt(this,"scaleStep",.1),Nt(this,"themeColor","#39f")}static get observedAttributes(){return super.observedAttributes.concat(["background","disabled","scale-step"])}connectedCallback(){super.connectedCallback(),this.disabled||this.$bind()}disconnectedCallback(){this.disabled||this.$unbind(),super.disconnectedCallback()}$propertyChangedCallback(t,e,n){Object.is(n,e)||(super.$propertyChangedCallback(t,e,n),"disabled"!==t)||(n?this.$unbind():this.$bind())}$bind(){this.$onPointerDown||(this.$onPointerDown=this.$handlePointerDown.bind(this),lt(this,P,this.$onPointerDown)),this.$onPointerMove||(this.$onPointerMove=this.$handlePointerMove.bind(this),lt(this.ownerDocument,M,this.$onPointerMove)),this.$onPointerUp||(this.$onPointerUp=this.$handlePointerUp.bind(this),lt(this.ownerDocument,z,this.$onPointerUp)),this.$onWheel||(this.$onWheel=this.$handleWheel.bind(this),lt(this,X,this.$onWheel,{passive:!1,capture:!0}))}$unbind(){this.$onPointerDown&&(ct(this,P,this.$onPointerDown),this.$onPointerDown=null),this.$onPointerMove&&(ct(this.ownerDocument,M,this.$onPointerMove),this.$onPointerMove=null),this.$onPointerUp&&(ct(this.ownerDocument,z,this.$onPointerUp),this.$onPointerUp=null),this.$onWheel&&(ct(this,X,this.$onWheel,{capture:!0}),this.$onWheel=null)}$handlePointerDown(t){const{buttons:e,button:n,type:i}=t;if(this.disabled||("pointerdown"===i&&"mouse"===t.pointerType||"mousedown"===i)&&(F(e)&&1!==e||F(n)&&0!==n||t.ctrlKey))return;const{$pointers:s}=this;let r="";if(t.changedTouches)Array.from(t.changedTouches).forEach((({identifier:t,pageX:e,pageY:n})=>{s.set(t,{startX:e,startY:n,endX:e,endY:n})}));else{const{pointerId:e=0,pageX:n,pageY:i}=t;s.set(e,{startX:n,startY:i,endX:n,endY:i})}s.size>1?r=w:it(t.target)&&(r=t.target.action||t.target.getAttribute(N)||""),!1!==this.$emit(L,{action:r,relatedEvent:t})&&(t.preventDefault(),this.$action=r,this.style.willChange="transform")}$handlePointerMove(t){const{$action:e,$pointers:n}=this;if(this.disabled||e===C||0===n.size)return;if(!1===this.$emit(U,{action:e,relatedEvent:t}))return;if(t.preventDefault(),t.changedTouches)Array.from(t.changedTouches).forEach((({identifier:t,pageX:e,pageY:i})=>{const s=n.get(t);s&&Object.assign(s,{endX:e,endY:i})}));else{const{pointerId:e=0,pageX:i,pageY:s}=t,r=n.get(e);r&&Object.assign(r,{endX:i,endY:s})}const i={action:e,relatedEvent:t};if(e===w){const e=new Map(n);let s=0,r=0,o=0,a=0,h=t.pageX,c=t.pageY;n.forEach(((t,n)=>{e.delete(n),e.forEach((e=>{let n=e.startX-t.startX,i=e.startY-t.startY,l=e.endX-t.endX,u=e.endY-t.endY,d=0,p=0,f=0,$=0;if(0===n?i<0?f=2*Math.PI:i>0&&(f=Math.PI):n>0?f=Math.PI/2+Math.atan(i/n):n<0&&(f=1.5*Math.PI+Math.atan(i/n)),0===l?u<0?$=2*Math.PI:u>0&&($=Math.PI):l>0?$=Math.PI/2+Math.atan(u/l):l<0&&($=1.5*Math.PI+Math.atan(u/l)),$>0||f>0){const n=$-f,i=Math.abs(n);i>s&&(s=i,o=n,h=(t.startX+e.startX)/2,c=(t.startY+e.startY)/2)}if(n=Math.abs(n),i=Math.abs(i),l=Math.abs(l),u=Math.abs(u),n>0&&i>0?d=Math.sqrt(n*n+i*i):n>0?d=n:i>0&&(d=i),l>0&&u>0?p=Math.sqrt(l*l+u*u):l>0?p=l:u>0&&(p=u),d>0&&p>0){const n=(p-d)/d,i=Math.abs(n);i>r&&(r=i,a=n,h=(t.startX+e.startX)/2,c=(t.startY+e.startY)/2)}}))}));const l=s>0,u=r>0;l&&u?(i.rotate=o,i.scale=a,i.centerX=h,i.centerY=c):l?(i.action=v,i.rotate=o,i.centerX=h,i.centerY=c):u?(i.action=b,i.scale=a,i.centerX=h,i.centerY=c):i.action=C}else{const[t]=Array.from(n.values());Object.assign(i,t)}n.forEach((t=>{t.startX=t.endX,t.startY=t.endY})),i.action!==C&&this.$emit(j,i,{cancelable:!1})}$handlePointerUp(t){const{$action:e,$pointers:n}=this;if(!this.disabled&&e!==C&&!1!==this.$emit(H,{action:e,relatedEvent:t})){if(t.preventDefault(),t.changedTouches)Array.from(t.changedTouches).forEach((({identifier:t})=>{n.delete(t)}));else{const{pointerId:e=0}=t;n.delete(e)}0===n.size&&(this.style.willChange="",this.$action=C)}}$handleWheel(t){if(this.disabled)return;if(t.preventDefault(),this.$wheeling)return;this.$wheeling=!0,setTimeout((()=>{this.$wheeling=!1}),50);const e=(t.deltaY>0?1:-1)*this.scaleStep;this.$emit(j,{action:b,scale:e,relatedEvent:t},{cancelable:!1})}$setAction(t){return K(t)&&(this.$action=t),this}$toCanvas(t){return new Promise(((e,n)=>{if(!this.isConnected)return void n(new Error("The current element is not connected to the DOM."));const i=document.createElement("canvas"),s=this.offsetWidth,r=this.offsetHeight;i.width=s,i.height=r;const o=this.querySelector(this.$getTagNameOf(d));o?o.$ready().then((n=>{const a=i.getContext("2d");if(a){const[e,h,c,l,u,d]=o.$getTransform(),p=n.naturalWidth/2,f=n.naturalHeight/2;a.fillStyle="transparent",a.fillRect(0,0,s,r),et(t)&&nt(t.beforeDraw)&&t.beforeDraw.call(this,a,i),a.save(),a.translate(p,f),a.transform(e,h,c,l,u,d),a.translate(-p,-f),a.drawImage(n,0,0),a.restore()}e(i)})).catch(n):e(i)})).then((e=>{if(et(t)&&(G(t.width)||G(t.height))){let{width:n,height:i}=e;if(({width:n,height:i}=vt({aspectRatio:n/i,width:t.width,height:t.height})),n!==e.width){const t=document.createElement("canvas"),s=t.getContext("2d");return t.width=n,t.height=i,s&&s.drawImage(e,0,0,n,i),t}}return e}))}}Nt(_t,"$name",h),Nt(_t,"$version","__VERSION__");var Rt=Object.defineProperty,It=(t,e,n)=>(((t,e,n)=>{e in t?Rt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const Pt=new WeakMap,Mt=["alt","crossorigin","decoding","importance","loading","referrerpolicy","sizes","src","srcset"];class zt extends Ot{constructor(){super(...arguments),It(this,"$matrix",[1,0,0,1,0,0]),It(this,"$onCanvasAction",null),It(this,"$style","\n:host {\n  display: inline-block;\n}\n\nimg {\n  display: block;\n  height: 100%;\n  max-height: none !important;\n  max-width: none !important;\n  min-height: 0 !important;\n  min-width: 0 !important;\n  width: 100%;\n}\n"),It(this,"$image",new Image),It(this,"rotatable",!0),It(this,"scalable",!0),It(this,"skewable",!0),It(this,"slottable",!1),It(this,"translatable",!0)}set $canvas(t){Pt.set(this,t)}get $canvas(){return Pt.get(this)}static get observedAttributes(){return super.observedAttributes.concat(Mt,["rotatable","scalable","skewable","translatable"])}attributeChangedCallback(t,e,n){Object.is(n,e)||(super.attributeChangedCallback(t,e,n),Mt.includes(t)&&this.$image.setAttribute(t,n))}connectedCallback(){super.connectedCallback();const{$image:t}=this;t.src&&this.$ready((t=>{this.$setStyles({width:t.naturalWidth,height:t.naturalHeight})}));const e=this.closest(this.$getTagNameOf(h));e&&(this.$canvas=e,this.$setStyles({position:"absolute"}),t.src&&this.$ready((()=>{this.$center("cover")})),this.$onCanvasAction=this.$handleAction.bind(this),lt(e,j,this.$onCanvasAction)),this.$getShadowRoot().appendChild(t)}disconnectedCallback(){const{$canvas:t}=this;t&&this.$onCanvasAction&&(ct(t,j,this.$onCanvasAction),this.$onCanvasAction=null),this.$getShadowRoot().removeChild(this.$image),super.disconnectedCallback()}$handleAction(t){if(this.hidden||!(this.rotatable||this.scalable||this.translatable))return;const{$canvas:e}=this,{detail:n}=t;if(n){const{relatedEvent:t}=n;let{action:i}=n;switch(i!==w||this.rotatable&&this.scalable||(i=this.rotatable?v:this.scalable?b:C),i){case g:if(this.translatable){const i=this.$getTagNameOf(p);let s=e.querySelector(i);s&&s.multiple&&!s.active&&(s=e.querySelector(`${i}[active]`)),s&&!s.hidden&&s.movable&&t&&s.contains(t.target)||this.$move(n.endX-n.startX,n.endY-n.startY)}break;case v:if(this.rotatable)if(t){const{x:e,y:i}=this.getBoundingClientRect();this.$rotate(n.rotate,t.clientX-e,t.clientY-i)}else this.$rotate(n.rotate);break;case b:if(this.scalable)if(t){const{x:e,y:i}=this.getBoundingClientRect();this.$zoom(n.scale,t.clientX-e,t.clientY-i)}else this.$zoom(n.scale);break;case w:if(this.rotatable&&this.scalable){const{rotate:e}=n;let{scale:i}=n;i<0?i=1/(1-i):i+=1;const s=Math.cos(e),r=Math.sin(e),[o,a,h,c]=[s*i,r*i,-r*i,s*i];if(t){const e=this.getBoundingClientRect(),n=t.clientX-e.x,i=t.clientY-e.y,[s,r,l,u]=this.$matrix,d=e.width/2,p=i-e.height/2,f=((n-d)*u-l*p)/(s*u-l*r),$=(p-r*f)/u;this.$transform(o,a,h,c,f*(1-o)+$*h,$*(1-c)+f*a)}else this.$transform(o,a,h,c,0,0)}}}}$ready(t){const{$image:e}=this,n=new Promise(((t,n)=>{const i=new Error("Failed to load the image source");if(e.complete)e.naturalWidth>0&&e.naturalHeight>0?t(e):n(i);else{const s=()=>{ct(e,D,r),t(e)},r=()=>{ct(e,Y,s),n(i)};ut(e,Y,s),ut(e,D,r)}}));return nt(t)&&n.then((e=>(t(e),e))),n}$center(t){const{parentElement:e}=this;if(!e)return this;const n=e.getBoundingClientRect(),i=n.width,s=n.height,{x:r,y:o,width:a,height:h}=this.getBoundingClientRect(),c=r+a/2,l=o+h/2,u=n.x+i/2,d=n.y+s/2;if(this.$move(u-c,d-l),t&&(a!==i||h!==s)){const e=i/a,n=s/h;switch(t){case"cover":this.$scale(Math.max(e,n));break;case"contain":this.$scale(Math.min(e,n))}}return this}$move(t,e=t){if(this.translatable&&F(t)&&F(e)){const[n,i,s,r]=this.$matrix,o=(t*r-s*e)/(n*r-s*i),a=(e-i*o)/r;this.$translate(o,a)}return this}$moveTo(t,e=t){if(this.translatable&&F(t)&&F(e)){const[n,i,s,r]=this.$matrix,o=(t*r-s*e)/(n*r-s*i),a=(e-i*o)/r;this.$setTransform(n,i,s,r,o,a)}return this}$rotate(t,e,n){if(this.rotatable){const i=bt(t),s=Math.cos(i),r=Math.sin(i),[o,a,h,c]=[s,r,-r,s];if(F(e)&&F(n)){const[t,i,s,r]=this.$matrix,{width:l,height:u}=this.getBoundingClientRect(),d=n-u/2,p=((e-l/2)*r-s*d)/(t*r-s*i),f=(d-i*p)/r;this.$transform(o,a,h,c,p*(1-o)-f*h,f*(1-c)-p*a)}else this.$transform(o,a,h,c,0,0)}return this}$zoom(t,e,n){if(!this.scalable||0===t)return this;if(t<0?t=1/(1-t):t+=1,F(e)&&F(n)){const[i,s,r,o]=this.$matrix,{width:a,height:h}=this.getBoundingClientRect(),c=n-h/2,l=((e-a/2)*o-r*c)/(i*o-r*s),u=(c-s*l)/o;this.$transform(t,0,0,t,l*(1-t),u*(1-t))}else this.$scale(t);return this}$scale(t,e=t){return this.scalable&&this.$transform(t,0,0,e,0,0),this}$skew(t,e=0){if(this.skewable){const n=bt(t),i=bt(e);this.$transform(1,Math.tan(i),Math.tan(n),1,0,0)}return this}$translate(t,e=t){return this.translatable&&F(t)&&F(e)&&this.$transform(1,0,0,1,t,e),this}$transform(t,e,n,i,s,r){if(F(t)&&F(e)&&F(n)&&F(i)&&F(s)&&F(r)){const[o,a,h,c,l,u]=this.$matrix,[d,p,f,$,m,g]=[t,e,n,i,s,r];return this.$setTransform(o*d+h*p,a*d+c*p,o*f+h*$,a*f+c*$,o*m+h*g+l,a*m+c*g+u)}return this}$setTransform(t,e,n,i,s,r){if((this.rotatable||this.scalable||this.skewable||this.translatable)&&(Array.isArray(t)&&([t,e,n,i,s,r]=t),F(t)&&F(e)&&F(n)&&F(i)&&F(s)&&F(r))){const o=[t,e,n,i,s,r];if(!1===this.$emit(B,{matrix:o,oldMatrix:this.$matrix}))return this;this.$matrix=o,this.style.transform=`matrix(${o.join(", ")})`}return this}$getTransform(){return this.$matrix.slice()}$resetTransform(){return this.$setTransform([1,0,0,1,0,0])}}It(zt,"$name",d),It(zt,"$version","__VERSION__");var Dt=Object.defineProperty,Wt=(t,e,n)=>(((t,e,n)=>{e in t?Dt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const Yt=new WeakMap;class Vt extends Ot{constructor(){super(...arguments),Wt(this,"$onCanvasChange",null),Wt(this,"$onCanvasActionEnd",null),Wt(this,"$onCanvasActionStart",null),Wt(this,"$style","\n:host {\n  display: block;\n  height: 0;\n  left: 0;\n  outline: var(--theme-color) solid 1px;\n  position: relative;\n  top: 0;\n  width: 0;\n}\n\n:host([transparent]) {\n  outline-color: transparent;\n}\n"),Wt(this,"x",0),Wt(this,"y",0),Wt(this,"width",0),Wt(this,"height",0),Wt(this,"slottable",!1),Wt(this,"themeColor","rgba(0, 0, 0, 0.65)")}set $canvas(t){Yt.set(this,t)}get $canvas(){return Yt.get(this)}static get observedAttributes(){return super.observedAttributes.concat(["height","width","x","y"])}connectedCallback(){super.connectedCallback();const t=this.closest(this.$getTagNameOf(h));if(t){this.$canvas=t,this.style.position="absolute";const e=t.querySelector(this.$getTagNameOf(p));e&&(this.$onCanvasActionStart=t=>{e.hidden&&t.detail.action===m&&(this.hidden=!1)},this.$onCanvasActionEnd=t=>{e.hidden&&t.detail.action===m&&(this.hidden=!0)},this.$onCanvasChange=t=>{const{x:n,y:i,width:s,height:r}=t.detail;this.$change(n,i,s,r),(e.hidden||0===n&&0===i&&0===s&&0===r)&&(this.hidden=!0)},lt(t,L,this.$onCanvasActionStart),lt(t,H,this.$onCanvasActionEnd),lt(t,q,this.$onCanvasChange))}this.$render()}disconnectedCallback(){const{$canvas:t}=this;t&&(this.$onCanvasActionStart&&(ct(t,L,this.$onCanvasActionStart),this.$onCanvasActionStart=null),this.$onCanvasActionEnd&&(ct(t,H,this.$onCanvasActionEnd),this.$onCanvasActionEnd=null),this.$onCanvasChange&&(ct(t,q,this.$onCanvasChange),this.$onCanvasChange=null)),super.disconnectedCallback()}$change(t,e,n=this.width,i=this.height){return F(t)&&F(e)&&F(n)&&F(i)&&(t!==this.x||e!==this.y||n!==this.width||i!==this.height)?(this.hidden&&(this.hidden=!1),this.x=t,this.y=e,this.width=n,this.height=i,this.$render()):this}$reset(){return this.$change(0,0,0,0)}$render(){return this.$setStyles({transform:`translate(${this.x}px, ${this.y}px)`,width:this.width,height:this.height,outlineWidth:s.innerWidth})}}Wt(Vt,"$name",f),Wt(Vt,"$version","__VERSION__");var Xt=Object.defineProperty,jt=(t,e,n)=>(((t,e,n)=>{e in t?Xt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class Ht extends Ot{constructor(){super(...arguments),jt(this,"$onCanvasCropEnd",null),jt(this,"$onCanvasCropStart",null),jt(this,"$style",'\n:host {\n  background-color: var(--theme-color);\n  display: block;\n}\n\n:host([action="move"]),\n:host([action="select"]) {\n  height: 100%;\n  left: 0;\n  position: absolute;\n  top: 0;\n  width: 100%;\n}\n\n:host([action="move"]) {\n  cursor: move;\n}\n\n:host([action="select"]) {\n  cursor: crosshair;\n}\n\n:host([action$="-resize"]) {\n  background-color: transparent;\n  height: 15px;\n  position: absolute;\n  width: 15px;\n}\n\n:host([action$="-resize"])::after {\n  background-color: var(--theme-color);\n  content: "";\n  display: block;\n  height: 5px;\n  left: 50%;\n  top: 50%;\n  position: absolute;\n  width: 5px;\n  transform: translate(-50%, -50%);\n}\n\n:host([action="n-resize"]),\n:host([action="s-resize"]) {\n  cursor: ns-resize;\n  left: 50%;\n  transform: translateX(-50%);\n  width: 100%;\n}\n\n:host([action="n-resize"]) {\n  top: -8px;\n}\n\n:host([action="s-resize"]) {\n  bottom: -8px;\n}\n\n:host([action="e-resize"]),\n:host([action="w-resize"]) {\n  cursor: ew-resize;\n  height: 100%;\n  top: 50%;\n  transform: translateY(-50%);\n}\n\n:host([action="e-resize"]) {\n  right: -8px;\n}\n\n:host([action="w-resize"]) {\n  left: -8px;\n}\n\n:host([action="ne-resize"]) {\n  cursor: nesw-resize;\n  right: -8px;\n  top: -8px;\n}\n\n:host([action="nw-resize"]) {\n  cursor: nwse-resize;\n  left: -8px;\n  top: -8px;\n}\n\n:host([action="se-resize"]) {\n  cursor: nwse-resize;\n  right: -8px;\n  bottom: -8px;\n}\n\n:host([action="se-resize"])::after {\n  height: 15px;\n  width: 15px;\n}\n\n@media (pointer: coarse) {\n  :host([action="se-resize"])::after {\n    height: 10px;\n    width: 10px;\n  }\n}\n\n@media (pointer: fine) {\n  :host([action="se-resize"])::after {\n    height: 5px;\n    width: 5px;\n  }\n}\n\n:host([action="sw-resize"]) {\n  cursor: nesw-resize;\n  left: -8px;\n  bottom: -8px;\n}\n\n:host([plain]) {\n  background-color: transparent;\n}\n'),jt(this,"action",C),jt(this,"plain",!1),jt(this,"slottable",!1),jt(this,"themeColor","rgba(51, 153, 255, 0.5)")}static get observedAttributes(){return super.observedAttributes.concat(["action","plain"])}}jt(Ht,"$name",u),jt(Ht,"$version","__VERSION__");var Ut=Object.defineProperty,Lt=(t,e,n)=>(((t,e,n)=>{e in t?Ut(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const qt=new WeakMap;class Bt extends Ot{constructor(){super(...arguments),Lt(this,"$onCanvasAction",null),Lt(this,"$onCanvasActionStart",null),Lt(this,"$onDocumentKeyDown",null),Lt(this,"$style","\n:host {\n  display: block;\n  left: 0;\n  position: relative;\n  right: 0;\n}\n\n:host([outlined]) {\n  outline: 1px solid var(--theme-color);\n}\n\n:host([multiple]) {\n  outline: 1px dashed rgba(255, 255, 255, 0.5);\n}\n\n:host([multiple])::after {\n  bottom: 0;\n  content: '';\n  cursor: pointer;\n  display: block;\n  left: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n:host([multiple][active]) {\n  outline-color: var(--theme-color);\n  z-index: 1;\n}\n\n:host([multiple]) > * {\n  visibility: hidden;\n}\n\n:host([multiple][active]) > * {\n  visibility: visible;\n}\n\n:host([multiple][active])::after {\n  display: none;\n}\n"),Lt(this,"x",0),Lt(this,"y",0),Lt(this,"width",0),Lt(this,"height",0),Lt(this,"aspectRatio",NaN),Lt(this,"initialAspectRatio",NaN),Lt(this,"initialCoverage",NaN),Lt(this,"active",!1),Lt(this,"movable",!1),Lt(this,"resizable",!1),Lt(this,"zoomable",!1),Lt(this,"multiple",!1),Lt(this,"keyboard",!1),Lt(this,"outlined",!1),Lt(this,"precise",!1)}set $canvas(t){qt.set(this,t)}get $canvas(){return qt.get(this)}static get observedAttributes(){return super.observedAttributes.concat(["active","aspect-ratio","height","initial-aspect-ratio","initial-coverage","keyboard","movable","multiple","outlined","precise","resizable","width","x","y","zoomable"])}$propertyChangedCallback(t,e,n){if(!Object.is(n,e))switch(super.$propertyChangedCallback(t,e,n),t){case"aspectRatio":G(n)||(this.aspectRatio=NaN);break;case"initialAspectRatio":G(n)||(this.initialAspectRatio=NaN);break;case"initialCoverage":(!G(n)||n>1)&&(this.initialCoverage=NaN);break;case"keyboard":this.$nextTick((()=>{this.$canvas&&(n?this.$onDocumentKeyDown||(this.$onDocumentKeyDown=this.$handleKeyDown.bind(this),lt(this.ownerDocument,W,this.$onDocumentKeyDown)):this.$onDocumentKeyDown&&(ct(this.ownerDocument,W,this.$onDocumentKeyDown),this.$onDocumentKeyDown=null))}));break;case"multiple":this.$nextTick((()=>{this.$canvas&&(n?(this.active=!0,this.$onCanvasActionStart||(this.$onCanvasActionStart=this.$handleActionStart.bind(this),lt(this.$canvas,L,this.$onCanvasActionStart))):(this.$onCanvasActionStart&&(ct(this.$canvas,L,this.$onCanvasActionStart),this.$onCanvasActionStart=null),this.$getSelections().forEach(((t,e)=>{e>0&&this.$removeSelection(t)})),this.active=!1))}))}}connectedCallback(){super.connectedCallback(),this.multiple&&!this.active&&(this.active=!0);const t=this.closest(this.$getTagNameOf(h));if(t){this.$canvas=t,this.$setStyles({position:"absolute",transform:`translate(${this.x}px, ${this.y}px)`}),this.hidden||this.$render();const{initialCoverage:e,parentElement:n}=this;if(G(e)&&n){const t=this.aspectRatio||this.initialAspectRatio,{offsetWidth:i,offsetHeight:s}=n;let r=i*e,o=s*e;G(t)&&({width:r,height:o}=vt({aspectRatio:t,width:r,height:o})),this.$change(this.x,this.y,r,o),this.$center()}this.$onCanvasAction=this.$handleAction.bind(this),lt(t,j,this.$onCanvasAction)}else this.$render()}disconnectedCallback(){const{$canvas:t}=this;t&&this.$onCanvasAction&&(ct(t,j,this.$onCanvasAction),this.$onCanvasAction=null),super.disconnectedCallback()}$getSelections(){let t=[];return this.parentElement&&(t=Array.from(this.parentElement.querySelectorAll(this.$getTagNameOf(p)))),t}$createSelection(){const t=this.cloneNode(!0);return this.hasAttribute("id")&&t.removeAttribute("id"),this.active=!1,this.parentElement&&this.parentElement.insertBefore(t,this.nextSibling),t}$removeSelection(t=this){if(this.parentElement){const e=this.$getSelections();if(e.length>1){const n=e.indexOf(t),i=e[n+1]||e[n-1];i&&(this.parentElement.removeChild(t),i.active=!0,i.$emit(q,{x:i.x,y:i.y,width:i.width,height:i.height}))}else this.$reset(),this.hidden=!0}}$handleActionStart(t){if(this.hidden||!this.multiple||this.active)return;const{detail:e}=t,{relatedEvent:n}=e;n.target===this&&this.parentElement&&(this.$getSelections().forEach((t=>{t.active=!1})),this.active=!0,this.$emit(q,{x:this.x,y:this.y,width:this.width,height:this.height}))}$handleAction(t){if(this.multiple&&!this.active)return;const{currentTarget:e,detail:n}=t;if(e&&n){const{relatedEvent:i}=n;let{action:s}=n;if(!s&&this.multiple&&(s=null==i?void 0:i.target.action),!s||this.hidden&&s!==m)return;const r=n.endX-n.startX,o=n.endY-n.startY,{width:a,height:h}=this;let{aspectRatio:c}=this;switch(!G(c)&&t.shiftKey&&(c=G(a)&&G(h)?a/h:1),s){case m:{const{$canvas:t}=this,i=mt(e);(this.multiple&&!this.hidden?this.$createSelection():this).$change(n.startX-i.left,n.startY-i.top,r,o,c),s=O,r<0?o>0?s=x:o<0&&(s=k):r>0&&o<0&&(s=T),t&&(t.$action=s);break}case g:!this.movable||i&&!this.contains(i.target)||this.$move(r,o);break;case b:if(i&&this.zoomable){const t=mt(e);this.$zoom(n.scale,i.pageX-t.left,i.pageY-t.top)}break;default:this.$resize(s,r,o,c)}}}$handleKeyDown(t){if(!(this.hidden||!this.keyboard||this.multiple&&!this.active||t.defaultPrevented))switch(t.key){case"Backspace":t.metaKey&&(t.preventDefault(),this.$removeSelection());break;case"Delete":t.preventDefault(),this.$removeSelection();break;case"ArrowLeft":t.preventDefault(),this.$move(-1,0);break;case"ArrowRight":t.preventDefault(),this.$move(1,0);break;case"ArrowUp":t.preventDefault(),this.$move(0,-1);break;case"ArrowDown":t.preventDefault(),this.$move(0,1);break;case"+":t.preventDefault(),this.$zoom(.1);break;case"-":t.preventDefault(),this.$zoom(-.1)}}$center(){const{parentElement:t}=this;if(!t)return this;const e=(t.offsetWidth-this.width)/2,n=(t.offsetHeight-this.height)/2;return this.$change(e,n)}$move(t,e=t){return this.$moveTo(this.x+t,this.y+e)}$moveTo(t,e=t){return this.movable?this.$change(t,e):this}$resize(t,e=0,n=0,i=this.aspectRatio){if(!this.resizable)return this;const s=G(i),{$canvas:r}=this;let{x:o,y:a,width:h,height:c}=this;switch(t){case y:a+=n,c-=n,c<0&&(t=S,c=-c,a-=c),s&&(o+=(e=n*i)/2,h-=e,h<0&&(h=-h,o-=h));break;case E:h+=e,h<0&&(t=A,h=-h,o-=h),s&&(a-=(n=e/i)/2,c+=n,c<0&&(c=-c,a-=c));break;case S:c+=n,c<0&&(t=y,c=-c,a-=c),s&&(o-=(e=n*i)/2,h+=e,h<0&&(h=-h,o-=h));break;case A:o+=e,h-=e,h<0&&(t=E,h=-h,o-=h),s&&(a+=(n=e/i)/2,c-=n,c<0&&(c=-c,a-=c));break;case T:s&&(n=-e/i),a+=n,c-=n,h+=e,h<0&&c<0?(t=x,h=-h,c=-c,o-=h,a-=c):h<0?(t=k,h=-h,o-=h):c<0&&(t=O,c=-c,a-=c);break;case k:s&&(n=e/i),o+=e,a+=n,h-=e,c-=n,h<0&&c<0?(t=O,h=-h,c=-c,o-=h,a-=c):h<0?(t=T,h=-h,o-=h):c<0&&(t=x,c=-c,a-=c);break;case O:s&&(n=e/i),h+=e,c+=n,h<0&&c<0?(t=k,h=-h,c=-c,o-=h,a-=c):h<0?(t=x,h=-h,o-=h):c<0&&(t=T,c=-c,a-=c);break;case x:s&&(n=-e/i),o+=e,h-=e,c+=n,h<0&&c<0?(t=T,h=-h,c=-c,o-=h,a-=c):h<0?(t=O,h=-h,o-=h):c<0&&(t=k,c=-c,a-=c)}return r&&r.$setAction(t),this.$change(o,a,h,c)}$zoom(t,e,n){if(!this.zoomable||0===t)return this;t<0?t=1/(1-t):t+=1;const{width:i,height:s}=this,r=i*t,o=s*t;let a=this.x,h=this.y;return F(e)&&F(n)?(a-=(r-i)*((e-this.x)/i),h-=(o-s)*((n-this.y)/s)):(a-=(r-i)/2,h-=(o-s)/2),this.$change(a,h,r,o)}$change(t,e,n=this.width,i=this.height,s=this.aspectRatio){return F(t)&&F(e)&&F(n)&&F(i)?(this.precise||(t=Math.round(t),e=Math.round(e),n=Math.round(n),i=Math.round(i)),t===this.x&&e===this.y&&n===this.width&&i===this.height?this:(this.hidden&&(this.hidden=!1),G(s)&&({width:n,height:i}=vt({aspectRatio:s,width:n,height:i},"cover")),!1===this.$emit(q,{x:t,y:e,width:n,height:i})?this:(this.x=t,this.y=e,this.width=n,this.height=i,this.$render()))):this}$reset(){return this.$change(0,0,0,0)}$render(){return this.$setStyles({transform:`translate(${this.x}px, ${this.y}px)`,width:this.width,height:this.height})}$toCanvas(t){return new Promise(((e,n)=>{if(!this.isConnected)return void n(new Error("The current element is not connected to the DOM."));const i=document.createElement("canvas"),{$canvas:s,width:r,height:o}=this;if(i.width=r,i.height=o,!s)return void e(i);const a=s.querySelector(this.$getTagNameOf(d));a?a.$ready().then((n=>{const s=i.getContext("2d");if(s){const[e,h,c,l,u,d]=a.$getTransform(),p=n.naturalWidth/2,f=n.naturalHeight/2,$=-this.x,m=-this.y,g=($*l-c*m)/(e*l-c*h),b=(m-h*u)/l,v=e*g+c*b+u,w=h*g+l*b+d;s.fillStyle="transparent",s.fillRect(0,0,r,o),et(t)&&nt(t.beforeDraw)&&t.beforeDraw.call(this,s,i),s.save(),s.translate(p,f),s.transform(e,h,c,l,v,w),s.translate(-p,-f),s.drawImage(n,0,0),s.restore()}e(i)})).catch(n):e(i)})).then((e=>{if(et(t)&&(G(t.width)||G(t.height))){let{width:n,height:i}=e;if(({width:n,height:i}=vt({aspectRatio:n/i,width:t.width,height:t.height})),n!==e.width){const t=document.createElement("canvas"),s=t.getContext("2d");return t.width=n,t.height=i,s&&s.drawImage(e,0,0,n,i),t}}return e}))}}Lt(Bt,"$name",p),Lt(Bt,"$version","__VERSION__");var Kt=Object.defineProperty,Zt=(t,e,n)=>(((t,e,n)=>{e in t?Kt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class Ft extends Ot{constructor(){super(...arguments),Zt(this,"$style","\n:host {\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  touch-action: none;\n  user-select: none;\n}\n\n:host([bordered]) {\n  border: 1px dashed var(--theme-color);\n}\n\n:host([covered]) {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n:host > span {\n  display: flex;\n  flex: 1;\n}\n\n:host > span + span {\n  border-top: 1px dashed var(--theme-color);\n}\n\n:host > span > span {\n  flex: 1;\n}\n\n:host > span > span + span {\n  border-left: 1px dashed var(--theme-color);\n}\n"),Zt(this,"bordered",!1),Zt(this,"columns",3),Zt(this,"covered",!1),Zt(this,"rows",3),Zt(this,"slottable",!1),Zt(this,"themeColor","rgba(238, 238, 238, 0.5)")}static get observedAttributes(){return super.observedAttributes.concat(["bordered","columns","covered","rows"])}$propertyChangedCallback(t,e,n){Object.is(n,e)||(super.$propertyChangedCallback(t,e,n),"rows"!==t&&"columns"!==t||this.$render())}connectedCallback(){super.connectedCallback(),this.$render()}$render(){const t=this.$getShadowRoot(),e=document.createDocumentFragment();for(let t=0;t<this.rows;t+=1){const t=document.createElement("span");t.setAttribute("role","row");for(let e=0;e<this.columns;e+=1){const e=document.createElement("span");e.setAttribute("role","gridcell"),t.appendChild(e)}e.appendChild(t)}t&&(t.innerHTML="",t.appendChild(e))}}Zt(Ft,"$name",l),Zt(Ft,"$version","__VERSION__");var Gt=Object.defineProperty,Jt=(t,e,n)=>(((t,e,n)=>{e in t?Gt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class Qt extends Ot{constructor(){super(...arguments),Jt(this,"$style",'\n:host {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  touch-action: none;\n  user-select: none;\n  vertical-align: middle;\n  width: 1em;\n}\n\n:host::before,\n:host::after {\n  background-color: var(--theme-color);\n  content: "";\n  display: block;\n  position: absolute;\n}\n\n:host::before {\n  height: 1px;\n  left: 0;\n  top: 50%;\n  transform: translateY(-50%);\n  width: 100%;\n}\n\n:host::after {\n  height: 100%;\n  left: 50%;\n  top: 0;\n  transform: translateX(-50%);\n  width: 1px;\n}\n\n:host([centered]) {\n  left: 50%;\n  position: absolute;\n  top: 50%;\n  transform: translate(-50%, -50%);\n}\n'),Jt(this,"centered",!1),Jt(this,"slottable",!1),Jt(this,"themeColor","rgba(238, 238, 238, 0.5)")}static get observedAttributes(){return super.observedAttributes.concat(["centered"])}}Jt(Qt,"$name",c),Jt(Qt,"$version","__VERSION__");var te=Object.defineProperty,ee=(t,e,n)=>(((t,e,n)=>{e in t?te(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const ne=new WeakMap,ie=new WeakMap,se=new WeakMap,re="vertical";class oe extends Ot{constructor(){super(...arguments),ee(this,"$onSourceImageTransform",null),ee(this,"$onSelectionChange",null),ee(this,"$scale",1),ee(this,"$style","\n:host {\n  display: block;\n  height: 100%;\n  overflow: hidden;\n  position: relative;\n  width: 100%;\n}\n"),ee(this,"resize",re),ee(this,"selection",""),ee(this,"slottable",!1)}set $image(t){ne.set(this,t)}get $image(){return ne.get(this)}set $sourceImage(t){se.set(this,t)}get $sourceImage(){return se.get(this)}set $selection(t){ie.set(this,t)}get $selection(){return ie.get(this)}static get observedAttributes(){return super.observedAttributes.concat(["resize","selection"])}connectedCallback(){super.connectedCallback();let t=null;if(t=this.selection?this.ownerDocument.querySelector(this.selection):this.closest(this.$getTagNameOf(p)),it(t)){this.$selection=t,this.$onSelectionChange=this.$handleSelectionChange.bind(this),lt(t,q,this.$onSelectionChange);const e=t.closest(this.$getTagNameOf(h));if(e){const t=e.querySelector(this.$getTagNameOf(d));t&&(this.$sourceImage=t,this.$image=t.cloneNode(!0),this.$getShadowRoot().appendChild(this.$image),this.$onSourceImageTransform=this.$handleSourceImageTransform.bind(this),lt(t,B,this.$onSourceImageTransform))}this.$render()}}disconnectedCallback(){const{$selection:t,$sourceImage:e}=this;t&&this.$onSelectionChange&&(ct(t,q,this.$onSelectionChange),this.$onSelectionChange=null),e&&this.$onSourceImageTransform&&(ct(e,B,this.$onSourceImageTransform),this.$onSourceImageTransform=null),super.disconnectedCallback()}$handleSelectionChange(t){this.$render(t.detail)}$handleSourceImageTransform(t){const{x:e,y:n}=this.$selection;this.$transformImageByOffset(t.detail.matrix,-e,-n)}$render(t){const{x:e,y:n,width:i,height:s}=t||this.$selection,r={},{clientWidth:o,clientHeight:a}=this;let h=o,c=a,l=NaN;switch(this.resize){case"both":l=1,h=i,c=s,r.width=i,r.height=s;break;case"horizontal":l=a/s,h=i*l,r.width=h;break;case re:l=o/i,c=s*l,r.height=c;break;default:o>0?l=o/i:a>0&&(l=a/s)}this.$scale=l,this.$setStyles(r),this.$sourceImage&&this.$transformImageByOffset(this.$sourceImage.$getTransform(),-e,-n)}$transformImageByOffset(t,e,n){const{$image:i,$scale:s,$sourceImage:r}=this;if(r&&i&&s>0){const[r,o,a,h,c,l]=t,u=(e*h-a*n)/(r*h-a*o),d=(n-o*u)/h,p=r*u+a*d+c,f=o*u+h*d+l;i.$ready((t=>{this.$setStyles.call(i,{width:t.naturalWidth*s,height:t.naturalHeight*s})})),i.$setTransform(r,o,a,h,p*s,f*s)}}}ee(oe,"$name",$),ee(oe,"$version","__VERSION__");var ae=Object.defineProperty,he=(t,e,n)=>(((t,e,n)=>{e in t?ae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const ce=/^img|canvas$/,le=/<(\/?(?:script|style)[^>]*)>/gi,ue={template:'<cropper-canvas background><cropper-image></cropper-image><cropper-shade hidden></cropper-shade><cropper-handle action="select" plain></cropper-handle><cropper-selection initial-coverage="0.5" movable resizable zoomable><cropper-grid role="grid" bordered covered></cropper-grid><cropper-crosshair centered></cropper-crosshair><cropper-handle action="move" theme-color="rgba(255, 255, 255, 0.35)"></cropper-handle><cropper-handle action="n-resize"></cropper-handle><cropper-handle action="e-resize"></cropper-handle><cropper-handle action="s-resize"></cropper-handle><cropper-handle action="w-resize"></cropper-handle><cropper-handle action="ne-resize"></cropper-handle><cropper-handle action="nw-resize"></cropper-handle><cropper-handle action="se-resize"></cropper-handle><cropper-handle action="sw-resize"></cropper-handle></cropper-selection></cropper-canvas>'};_t.$define(),Qt.$define(),Ft.$define(),Ht.$define(),zt.$define(),Bt.$define(),Vt.$define(),oe.$define();class de{constructor(t,e){if(he(this,"element"),he(this,"options",ue),he(this,"container"),K(t)&&(t=document.querySelector(t)),!it(t)||!ce.test(t.localName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=t,e={...ue,...e},this.options=e;const{ownerDocument:n}=t;let{container:i}=e;if(i&&(K(i)&&(i=n.querySelector(i)),!it(i)))throw new Error("The `container` option must be an element or a valid selector.");it(i)||(i=t.parentElement?t.parentElement:n.body),this.container=i;const s=t.localName;let r="";"img"===s?({src:r}=t):"canvas"===s&&window.HTMLCanvasElement&&(r=t.toDataURL());const{template:o}=e;if(o&&K(o)){const e=document.createElement("template"),n=document.createDocumentFragment();e.innerHTML=o.replace(le,"&lt;$1&gt;"),n.appendChild(e.content),Array.from(n.querySelectorAll(d)).forEach((e=>{e.setAttribute("src",r),e.setAttribute("alt",t.alt||"The image to crop")})),t.parentElement?(t.style.display="none",i.insertBefore(n,t.nextSibling)):i.appendChild(n)}}getCropperCanvas(){return this.container.querySelector(h)}getCropperImage(){return this.container.querySelector(d)}getCropperSelection(){return this.container.querySelector(p)}getCropperSelections(){return this.container.querySelectorAll(p)}}he(de,"version","__VERSION__")}}]);